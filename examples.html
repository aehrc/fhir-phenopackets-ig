<!-- template for the static html pages not generated by build e.g., index, guidance , toc -->

<!DOCTYPE HTML>

<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Phenopackets</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Phenopackets Implemenation Guide" />
  <meta name="author" content=""/>
  <link href="fhir.css" rel="stylesheet"/>


  <!-- Bootstrap core CSS -->

  <!-- Latest compiled and minified CSS -->

  <link href="assets/css/bootstrap.css" rel="stylesheet"/>
  <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>
  <link href="assets/css/bootstrap-glyphicons.css" rel="stylesheet">

  <!-- Project extras -->
  <link href="assets/css/project.css" rel="stylesheet"/>
  <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
  <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  

  <!-- Favicons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png"/>
  <link rel="shortcut icon" href="assets/ico/favicon.png"/>


<body markdown="1">
<?xml version="1.0" encoding="UTF-8"?>
<div id="segment-header" class="segment">
  <!-- segment-header -->
  <div class="container"><!-- container -->

    <!-- hl7 logo -->
    <a no-external="true" href="http://aehrc.com">
      <img alt="AEHRC Homepage" class="img-responsive logo" src="assets/images/aehrc-logo.png"/>
    </a>
    <!-- end hl7 logo -->


    <!-- org logo -->
    <!--
<a id="your-logo" no-external="true" href="http://www.hl7.org">
<img height="50" alt="visit the hl7 website" width="42" src="assets/images/hl7-logo.png"/>
</a>

your logo here

[![visit our website](assets/images/org_logo.png)](your web site.html)
{: .img-responsive #org_logo}

can only resize using html  or css ;-(

-->


<a no-external="true" href="https://www.ga4gh.org/">
<img alt="GA4GH website" class="img-responsive project-logo" src="assets/images/ga4gh-logo.svg"/>
</a>

    <!-- end org logo -->


    <div id="project-status" class="project-status"> <!-- ig title text -->

      
      <strong>Phenopackets Implementation Guide CI Build</strong>
      

    </div><!-- end ig title text -->

  </div><!-- end container -->
  <div class="container">
    <!-- container -->
  </div>
</div>
<!-- /segment-header -->

<div id="segment-navbar" class="segment">
  <!-- segment-navbar -->
  <div id="stripe">
  </div>
  <div class="container">
    <!-- container -->
    <!-- HEADER CONTENT -->
    <nav class="navbar navbar-inverse">
      <div class="container">
        <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
          <span class="icon-bar">
          </span>
          <span class="icon-bar">
          </span>
          <span class="icon-bar">
          </span>
        </button>
        <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
        <div class="nav-collapse collapse navbar-inverse-collapse">

       <!-- don't remove the line above - choose what you want  
- [Home](index.html)
- [General Guidance](guidance.html)
- [Profiles and Logical Models](profiles.html)
- [Notice to Balloters](balloters.html)
- [Extensions](extensions.html)
- [Terminology](terminology.html)
- [Search Parameters](searchparams.html)
- [Capability Statements](capstatements.html)
- [Security](security.html)
- [Examples](examples.html)
- [Downloads](downloads.html)

- [General Guidance and Questions <span class="caret"></span>](#){: .dropdown-toggle data-toggle="dropdown"}
    - [eCR Exchange Transactions](ecr-exchange.html)
    - [Triggering / Decision Support](triggering.html)
    - [FHIR Timing and Roll-Out](fhir-timing.html)
    {: .dropdown-menu}
*****no empty lines****

-->
<ul class="nav navbar-nav">
  <li><a href="index.html">Home</a></li>
  <li><a href="guidance.html">Implementation Guidance</a></li>
  <li><a href="mapping.html">Mapping</a></li>
  <li><a href="profiles.html">Profiles</a></li>
  <li><a href="extensions.html">Extensions</a></li>
  <li><a href="terminology.html">Terminology</a></li>
  <li><a href="examples.html">Examples</a></li>
  <li><a href="downloads.html">Downloads</a></li>
</ul>

<!-- ******* how to create a dropdown menu in md ********
- [Capability Statements <span class="caret"></span>](#){: .dropdown-toggle data-toggle="dropdown"}
    - [Conformance requirements for Server](CapabilityStatement-server.html)
    - [Conformance requirements for Client](CapabilityStatement-client.html)
    {: .dropdown-menu}
-->


             <!--        <ul class="nav navbar-nav">
          <li>
            <a href="index.html">Home</a>
          </li>
          <li>
            <a href="guidance.html">General Guidance</a>
          </li>
          <li>
            <a href="profiles.html">Profiles and Logical Models</a>
          </li>
          <li>
            <a href="structuremaps.html">Mappings</a>
          </li>
          <li>
            <a href="extensions.html">Extensions</a>
          </li>
          <li>
            <a href="terminology.html">Terminology</a>
          </li>
          <li>
            <a href="searchparams.html">Search Parameters</a>
          </li>
          <li>
            <a href="capstatements.html">Capability Statements</a>
          </li>
          <li>
            <a href="security.html">Security</a>
          </li>
          <li>
            <a href="examples.html">Examples</a>
          </li>
          <li>
            <a href="downloads.html">Downloads</a>
          </li>
        </ul> -->
      </div>
      <!-- /.nav-collapse -->
    </div>
    <!-- /.container -->
  </nav>
  <!-- /.navbar -->
  <!-- /HEADER CONTENT -->
</div>
<!-- /container -->
</div>
<!-- /segment-navbar -->

</div>  <!-- /container -->
</div>  <!-- /segment-breadcrumb -->


<div id="page-content-wrapper">  <!-- page content wrapper -->
  <div class="page-content">  <!--page content -->
    <div class="container">  <!-- container -->
      <div class="row">  <!-- row -->
       <div class="inner-wrapper"> <!-- inner-wrapper -->
         <div class="col-12">  <!--col -->
            <!-- content of page -->


<!-- ============BreadCrumb=============== -->

<nav class="breadcrumb">
  
    
      <a class="breadcrumb-item" href="index.html">Home</a>
      /
      <span class="breadcrumb-item active">Examples</span>
    
    


</nav>


<!-- ============PublishBox=============== -->

<p id="publish-box">
This is the Continuous Integration Build <!-- Current officially released version --> of the Phenopackets Implementation Guide, based on FHIR Version 4.0.1. 

<!-- 
See the Directory of published versions based on <a
    href="http://hl7.org/fhir/R4/">FHIR Version 4.0.1</a>. See the <a href="#">Directory of published versions <img
      src="external.png" /></a>
 -->
</p>


  <!-- ============CONTENT CONTENT=============== -->

<h1>Examples</h1>

<!--page source: examples.md-->

<!-- { :.no_toc } -->

<!-- TOC  the css styling for this is \pages\assets\css\project.css under 'markdown-toc'-->

<!-- * Do not remove this line (it will not be displayed)
{:toc} -->

<!-- end TOC -->

<h3 id="working-with-phenopackets-on-fhir">Working with Phenopackets on FHIR</h3>

<p>FHIR defines a model that is independent of programming languages and data formats. There are many open source <a href="https://wiki.hl7.org/Open_Source_FHIR_implementations">FHIR reference libraries</a> and any of these can be used to create FHIR resources. In this guide we use the <a href="https://hapifhir.io/">HAPI FHIR</a> java implementation to create FHIR resource programatically and write them in JSON format.</p>

<p>The Phenopackets on FHIR Implementation Guide (IG) constrains and extends the base FHIR resources to describe concepts that are necessary to represent detailed patient phenotype information. However, the IG itself is not necessary to create thse resources. Compliant resources can be created using the existing FHIR APIs. The IG can be used, however, to validate that a resource is valid according to the constraints specified in the profiles. Also, the IG can be used to create a profile-aware API that facilitates the creation of compliant resources.</p>

<h4 id="java-standalone">Java (Standalone)</h4>

<p>A FHIR server is not needed to create a FHIR Phenopacket instance. The HAPI FHIR libraries can be used to create an instance, validate it against the IG and save it in JSON, XML or RDF.</p>

<p>The following steps will describe how to create a simple Phenopacket in Java and validate it using the IG. First, the HAPI dependencies need to be added to the project. If you are using Maven, these are:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>ca.uhn.hapi.fhir<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>hapi-fhir-base<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>4.0.1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>ca.uhn.hapi.fhir<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>hapi-fhir-structures-r4<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>4.0.1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>ca.uhn.hapi.fhir<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>hapi-fhir-validation<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>4.0.1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>ca.uhn.hapi.fhir<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>hapi-fhir-validation-resources-r4<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>4.0.1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.helger<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>ph-schematron<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>5.2.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.helger<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>ph-commons<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>9.3.8<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>
<p>Check the HAPI FHIR <a href="https://hapifhir.io/download.html">downloads page</a> for up to date dependencies.</p>

<p>Instructions on how to validate a FHIR resource using an implementation guide with the HAPI libraries can be found <a href="https://hapifhir.io/doc_validation.html">here</a>.</p>

<h4 id="java-server">Java (Server)</h4>

<p>The Phenopackets on FHIR can also be used to validate resources uploded to a FHIR server. Instructions on how to set up validation in the open source HAPI server can be found <a href="https://hapifhir.io/doc_rest_server_interceptor.html#_toc_requestresponse_validation">here</a>.</p>

<h3 id="examples">Examples</h3>

<h4 id="rare-disease">Rare Disease</h4>

<p>This example shows how to create a FHIR Phenopacket to represent a <a href="https://www.ncbi.nlm.nih.gov/pubmed/30808312">case report</a> about a boy with Bethlem myopathy.</p>

<p>The following block creates a FHIR Bundle that will contain everything. This bundle is of type <em>document</em> so the first element should be a <a href="https://www.hl7.org/fhir/composition.html">Composition resource</a>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Bundle</span> <span class="n">bundle</span> <span class="o">=</span> 
  <span class="k">new</span> <span class="nf">Bundle</span><span class="o">()</span>
    <span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">BundleType</span><span class="o">.</span><span class="na">DOCUMENT</span><span class="o">)</span>
    <span class="o">.</span><span class="na">setIdentifier</span><span class="o">(</span><span class="k">new</span> <span class="n">Identifier</span><span class="o">().</span><span class="na">setSystem</span><span class="o">(</span><span class="n">GA4GH_SYSTEM</span><span class="o">).</span><span class="na">setValue</span><span class="o">(</span><span class="n">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">()));</span>
<span class="n">bundle</span>
  <span class="o">.</span><span class="na">getMeta</span><span class="o">()</span>
    <span class="o">.</span><span class="na">setLastUpdated</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
</code></pre></div></div>

<p>The proband is represented as a profile on the Patient resource.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Patient</span> <span class="n">proband</span> <span class="o">=</span> 
  <span class="k">new</span> <span class="nf">Patient</span><span class="o">()</span>
    <span class="o">.</span><span class="na">setGender</span><span class="o">(</span><span class="n">AdministrativeGender</span><span class="o">.</span><span class="na">MALE</span><span class="o">);</span>
<span class="n">proband</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>
</code></pre></div></div>

<p>In Phenopackets on FHIR, the age of the patient is captured in an encounter, not directly in the individual.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Encounter</span> <span class="n">encounter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Encounter</span><span class="o">();</span>
<span class="n">encounter</span><span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="n">EncounterStatus</span><span class="o">.</span><span class="na">FINISHED</span><span class="o">);</span>
<span class="n">encounter</span><span class="o">.</span><span class="na">setClass_</span><span class="o">(</span><span class="k">new</span> <span class="n">Coding</span><span class="o">().</span><span class="na">setSystem</span><span class="o">(</span><span class="n">ACT_CODE</span><span class="o">).</span><span class="na">setCode</span><span class="o">(</span><span class="s">"IMP"</span><span class="o">).</span><span class="na">setDisplay</span><span class="o">(</span><span class="s">"inpatient encounter"</span><span class="o">));</span>
<span class="n">encounter</span><span class="o">.</span><span class="na">setSubject</span><span class="o">(</span><span class="k">new</span> <span class="n">Reference</span><span class="o">(</span><span class="n">proband</span><span class="o">));</span>
<span class="n">encounter</span><span class="o">.</span><span class="na">addExtension</span><span class="o">(</span><span class="n">AGE_URL</span><span class="o">,</span> <span class="k">new</span> <span class="n">Age</span><span class="o">().</span><span class="na">setSystem</span><span class="o">(</span><span class="n">UCUM</span><span class="o">).</span><span class="na">setCode</span><span class="o">(</span><span class="s">"a"</span><span class="o">).</span><span class="na">setValue</span><span class="o">(</span><span class="mi">14</span><span class="o">));</span>
<span class="n">encounter</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>
</code></pre></div></div>

<p>Variants are represented using a profile derived from the Genomics Reporting profile developed in the Genomics Reporting FHIR IG.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Observation</span> <span class="n">heterozygousCOL6A1Variant</span> <span class="o">=</span> 
    <span class="k">new</span> <span class="nf">Observation</span><span class="o">()</span>
      <span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="n">ObservationStatus</span><span class="o">.</span><span class="na">FINAL</span><span class="o">)</span>
      <span class="o">.</span><span class="na">setCode</span><span class="o">(</span><span class="n">getCodeableConcept</span><span class="o">(</span><span class="n">LOINC</span><span class="o">,</span> <span class="s">"69548-6"</span><span class="o">,</span> <span class="s">"Genetic variant assessment"</span><span class="o">))</span>
      <span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="n">getCodeableConcept</span><span class="o">(</span><span class="n">LOINC</span><span class="o">,</span> <span class="s">"LA9633-4"</span><span class="o">,</span> <span class="s">"Present"</span><span class="o">));</span>
<span class="n">heterozygousCOL6A1Variant</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>

<span class="n">heterozygousCOL6A1Variant</span>
  <span class="o">.</span><span class="na">addComponent</span><span class="o">()</span>
    <span class="o">.</span><span class="na">setCode</span><span class="o">(</span><span class="n">getCodeableConcept</span><span class="o">(</span><span class="n">LOINC</span><span class="o">,</span> <span class="s">"81290-9"</span><span class="o">,</span> <span class="s">"Genomic DNA change (gHGVS)"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="n">getCodeableConcept</span><span class="o">(</span><span class="n">HGVS</span><span class="o">,</span> <span class="s">"NM_001848.2:c.877G&gt;A"</span><span class="o">,</span> <span class="s">"Homo sapiens collagen type VI alpha 1 chain (COL6A1), mRNA"</span><span class="o">));</span>

<span class="n">heterozygousCOL6A1Variant</span>
  <span class="o">.</span><span class="na">addComponent</span><span class="o">()</span>
    <span class="o">.</span><span class="na">setCode</span><span class="o">(</span><span class="n">getCodeableConcept</span><span class="o">(</span><span class="n">LOINC</span><span class="o">,</span> <span class="s">"53034-5"</span><span class="o">,</span> <span class="s">"Allelic state"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="n">getCodeableConcept</span><span class="o">(</span><span class="n">LOINC</span><span class="o">,</span> <span class="s">"LA6706-1"</span><span class="o">,</span> <span class="s">"Heterozygous"</span><span class="o">));</span>
  
<span class="n">DiagnosticReport</span> <span class="n">report</span> <span class="o">=</span> 
    <span class="k">new</span> <span class="nf">DiagnosticReport</span><span class="o">()</span>
      <span class="o">.</span><span class="na">setCode</span><span class="o">(</span><span class="n">getCodeableConcept</span><span class="o">(</span><span class="n">LOINC</span><span class="o">,</span> <span class="s">"81247-9"</span><span class="o">,</span> <span class="s">"Master HL7 genetic variant reporting panel"</span><span class="o">))</span>
      <span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="n">DiagnosticReportStatus</span><span class="o">.</span><span class="na">FINAL</span><span class="o">)</span>
      <span class="o">.</span><span class="na">setSubject</span><span class="o">(</span><span class="k">new</span> <span class="n">Reference</span><span class="o">(</span><span class="n">proband</span><span class="o">));</span>
<span class="n">report</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>
<span class="n">report</span><span class="o">.</span><span class="na">addResult</span><span class="o">().</span><span class="na">setResource</span><span class="o">(</span><span class="n">heterozygousCOL6A1Variant</span><span class="o">);</span>  
</code></pre></div></div>

<p>A complex extension was created to represent an evidence element.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Extension</span> <span class="n">evidence</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Extension</span><span class="o">(</span><span class="n">EVIDENCE_URL</span><span class="o">);</span>
<span class="n">evidence</span><span class="o">.</span><span class="na">addExtension</span><span class="o">(</span><span class="s">"evidenceCode"</span><span class="o">,</span> <span class="n">getCodeableConcept</span><span class="o">(</span><span class="n">ECO</span><span class="o">,</span> <span class="s">"ECO:0000033"</span><span class="o">,</span> 
    <span class="s">"author statement supported by traceable reference"</span><span class="o">));</span>
<span class="n">Extension</span> <span class="n">reference</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Extension</span><span class="o">(</span><span class="n">REFERENCE_URL</span><span class="o">);</span>
<span class="n">reference</span><span class="o">.</span><span class="na">addExtension</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="k">new</span> <span class="n">UrlType</span><span class="o">(</span><span class="s">"http://www.ncbi.nlm.nih.gov/pubmed/30808312"</span><span class="o">));</span>
<span class="n">reference</span><span class="o">.</span><span class="na">addExtension</span><span class="o">(</span><span class="s">"description"</span><span class="o">,</span> <span class="k">new</span> <span class="n">StringType</span><span class="o">(</span>
    <span class="s">"COL6A1 mutation leading to Bethlem myopathy with recurrent hematuria: a case report."</span><span class="o">));</span>
<span class="n">evidence</span><span class="o">.</span><span class="na">addExtension</span><span class="o">(</span><span class="n">reference</span><span class="o">);</span>
</code></pre></div></div>

<p>Phenotypic features are represented as a profile on the Observation resource. Extensions were required to represent <em>severity</em>, <em>modifiers</em>, coded <em>onset</em> and <em>evidence</em>. The following example shows how to add an extension to represent coded onset. The other phenotypic features in the example are excluded for brevity.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Observation</span> <span class="n">decreasedFetalMovement</span> <span class="o">=</span> 
  <span class="k">new</span> <span class="nf">Observation</span><span class="o">()</span>
    <span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="n">ObservationStatus</span><span class="o">.</span><span class="na">FINAL</span><span class="o">)</span>
    <span class="o">.</span><span class="na">setCode</span><span class="o">(</span><span class="n">getCodeableConcept</span><span class="o">(</span><span class="n">HPO</span><span class="o">,</span> <span class="s">"HP:0001558"</span><span class="o">,</span> <span class="s">"Decreased fetal movement"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">setInterpretation</span><span class="o">(</span><span class="n">getInterpretation</span><span class="o">(</span><span class="kc">true</span><span class="o">))</span>
    <span class="o">.</span><span class="na">setSubject</span><span class="o">(</span><span class="k">new</span> <span class="n">Reference</span><span class="o">(</span><span class="n">proband</span><span class="o">));</span>
<span class="n">decreasedFetalMovement</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>
<span class="n">decreasedFetalMovement</span><span class="o">.</span><span class="na">addExtension</span><span class="o">(</span><span class="n">ONSET_URL</span><span class="o">,</span> 
    <span class="n">getCodeableConcept</span><span class="o">(</span><span class="n">HPO</span><span class="o">,</span> <span class="s">"HP:0011461"</span><span class="o">,</span> <span class="s">"Fetal onset"</span><span class="o">));</span>
<span class="n">decreasedFetalMovement</span><span class="o">.</span><span class="na">addExtension</span><span class="o">(</span><span class="n">evidence</span><span class="o">);</span>
</code></pre></div></div>

<p>A Phenopacket is represented as a Composition with different sections that contain references to all the resources that belong ot the Phenopacket. The resources can also reference other resources in the Phenopacket. For example, every Observation resource references the Individual that is the subject of the observation.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Composition</span> <span class="n">phenopacket</span> <span class="o">=</span> 
    <span class="k">new</span> <span class="nf">Composition</span><span class="o">()</span>
      <span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="n">CompositionStatus</span><span class="o">.</span><span class="na">FINAL</span><span class="o">)</span>
      <span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">getCodeableConcept</span><span class="o">(</span><span class="n">GA4GH_DOC_TYPE</span><span class="o">,</span> <span class="s">"phenopacket"</span><span class="o">,</span> <span class="s">"Phenopacket"</span><span class="o">))</span>
      <span class="o">.</span><span class="na">setDate</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">())</span>
      <span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">"Phenopacket"</span><span class="o">)</span>
      <span class="o">.</span><span class="na">setSubject</span><span class="o">(</span><span class="k">new</span> <span class="n">Reference</span><span class="o">(</span><span class="n">proband</span><span class="o">))</span>
      <span class="o">.</span><span class="na">addAuthor</span><span class="o">(</span><span class="k">new</span> <span class="n">Reference</span><span class="o">(</span><span class="n">author</span><span class="o">));</span>
  <span class="n">phenopacket</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>

<span class="k">if</span> <span class="o">(</span><span class="n">phenotypicFeatures</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">SectionComponent</span> <span class="n">phenotypicFeaturesSection</span> <span class="o">=</span> <span class="n">phenopacket</span>
    <span class="o">.</span><span class="na">addSection</span><span class="o">()</span>
      <span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">"Phenotypic Features"</span><span class="o">)</span>
      <span class="o">.</span><span class="na">setCode</span><span class="o">(</span><span class="n">getCodeableConcept</span><span class="o">(</span><span class="n">GA4GH_SECTION_TYPE</span><span class="o">,</span> <span class="s">"phenotypic-features"</span><span class="o">,</span> 
          <span class="s">"Phenotypic features"</span><span class="o">))</span>
      <span class="o">.</span><span class="na">setMode</span><span class="o">(</span><span class="n">SectionMode</span><span class="o">.</span><span class="na">SNAPSHOT</span><span class="o">);</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">Observation</span> <span class="n">obs</span> <span class="o">:</span> <span class="n">phenotypicFeatures</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">phenotypicFeaturesSection</span><span class="o">.</span><span class="na">addEntry</span><span class="o">(</span><span class="k">new</span> <span class="n">Reference</span><span class="o">(</span><span class="n">obs</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>
<span class="o">...</span>
</code></pre></div></div>

<p>The composition does not contain the resources directly. All the resources, including the composition, are added to a Bundle resource to be packaged and transmitted. The Composition resource is always the first entry in the bundle.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Bundle</span> <span class="n">bundle</span> <span class="o">=</span> 
    <span class="k">new</span> <span class="nf">Bundle</span><span class="o">()</span>
      <span class="o">.</span><span class="na">setType</span><span class="o">(</span><span class="n">BundleType</span><span class="o">.</span><span class="na">DOCUMENT</span><span class="o">)</span>
      <span class="o">.</span><span class="na">setIdentifier</span><span class="o">(</span><span class="k">new</span> <span class="n">Identifier</span><span class="o">()</span>
        <span class="o">.</span><span class="na">setSystem</span><span class="o">(</span><span class="n">GA4GH_SYSTEM</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="n">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">()));</span>
<span class="n">bundle</span>
  <span class="o">.</span><span class="na">getMeta</span><span class="o">()</span>
    <span class="o">.</span><span class="na">setLastUpdated</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>

<span class="n">bundle</span><span class="o">.</span><span class="na">addEntry</span><span class="o">()</span>
  <span class="o">.</span><span class="na">setResource</span><span class="o">(</span><span class="n">composition</span><span class="o">)</span>
  <span class="o">.</span><span class="na">setFullUrl</span><span class="o">(</span><span class="s">"urn:uuid:"</span> <span class="o">+</span> <span class="n">composition</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="o">...</span>
</code></pre></div></div>

<p>The JSON representation of the Phenopacket can be printed to the console by using the FHIR JSON parser.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">FhirContext</span> <span class="n">ctx</span> <span class="o">=</span> <span class="n">FhirContext</span><span class="o">.</span><span class="na">forR4</span><span class="o">();</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ctx</span><span class="o">.</span><span class="na">newJsonParser</span><span class="o">().</span><span class="na">setPrettyPrint</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span><span class="na">encodeResourceToString</span><span class="o">(</span><span class="n">bundle</span><span class="o">));</span>
</code></pre></div></div>

<h4 id="cancer">Cancer</h4>

<p>TODO</p>




  <!-- ==============END CONTENT END CONTENT=================== -->


</div>  <!-- col -->
</div>  <!-- /inner-wrapper -->
</div>  <!-- /row -->
</div>  <!-- /container -->
</div>  <!-- /page content -->
</div>  <!-- /page content wrapper -->




</div>

    </div>  <!-- /inner-wrapper -->
            </div>  <!-- /row -->
        </div>  <!-- /container -->

    </div>  <!-- /segment-content -->

<!--status-bar-->

<div id="segment-footer" class="segment" igtool="footer">  <!-- segment-footer -->
  <div class="container">  <!-- container -->
   <div class="inner-wrapper">
    <p>
      Phenopackets Version: 0.1.0  &reg;&copy; <a style="color: #81BEF7" href="http://hl7.org/fhir/R4/">FHIR Version: 4.0.1</a> (IG Publisher v4.0.1-a53ec6ee1b) generated on Mon, Dec 2, 2019 08:48+1000.
      | <a style="color: #81BEF7" href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemAdd&amp;tracker_id=677">Propose a change</a>
        <a style="color: #81BEF7" rel="license" href="http://hl7.org/fhir/R4/license.html"><img style="border-style: none;" alt="CC0" src="cc0.png"/></a>
        </span>
        </p>
   </div>  <!-- /inner-wrapper -->
  </div>  <!-- /container -->
 </div>  <!-- /segment-footer -->
  <!-- disqus thread -->
  <!-- disqus -->
  <!-- end disqus -->

 <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
  <div class="container">  <!-- container -->
  </div>  <!-- /container -->
 </div>  <!-- /segment-post-footer -->

 <!-- JS and analytics only. -->
<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="./assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
<script src="./assets/js/bootstrap.min.js"> </script>
<script src="./assets/js/respond.min.js"> </script>
<script src="./assets/js/anchor.min.js"> </script>
<script src="./assets/js/fhir.js"> </script>

<!-- Analytics Below
================================================== -->

<!-- add acnhors before the closing body tag. -->
<script> anchors.add()</script>
</body>
</html>

